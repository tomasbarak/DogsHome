<!DOCTYPE html>
<html lang="es">
<head>
    <%- include('./head.ejs'); %>
    <%- include('./stylesheets/publications/publications-style.ejs'); %>
    <%- include('./stylesheets/publications/publications-style.ejs'); %>
    <%- include('./stylesheets/publications/slider.ejs'); %>
    <%- include('./stylesheets/main/style-mainpage.ejs'); %>
    <%- include('./stylesheets/main/drawer-navigator-style.ejs'); %>

    <title>DogsHome | <%= name %></title>
    <link rel="icon" href="/images/DogsHomeLogo-ReDesign%20(Colorified&Final).png">

    <meta property="og:title" content="Dogshome | <%= name %>">
    <meta property="og:url" content="https://dogshome.com.ar/publicacion/<%= pubId %>"/>
    <meta property="og:description" content="<%= description %>">
    <meta property="og:image" content="<%= photo %> ">
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="es_ES" />

    <script src="/scripts/main/open-close-drawer.js"></script>
    <script src="/scripts/main/basic-navigation.js"></script>
    <script src="/scripts/publications/expand-menu.js"></script>
    <script src="/scripts/alerts/page-alerts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@3.6.9/dist/js/splide.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@3.6.9/dist/css/themes/splide-default.min.css">
</head>
<body>

<div id="search-bar">
    <div class="top-bar-section-cont" style="flex-direction: row; align-items: center;">
        <img src="/images/DogsHomeLogo-ReDesign%20(White&Final).png" alt style="height: 50px; width: 50px; margin-right: 10px" class="">

        <a id="main-button" class="desktop-elements nav-buttons" onclick="window.location = '/inicio'">Inicio</a>
        <a id="alerts-button" class="desktop-elements nav-buttons" onclick="navigateToAlerts()">Alertas</a>
    </div>
    <div class="top-bar-section-cont">
        <form id="search-form">
            <div id="search-input-container" style="width: 100%; height: 100%; max-width: 600px; flex-direction: row; display: flex; align-items: center; justify-content: center; background-color: white">
                <input type="text" id="search-input" aria-label="Buscar" placeholder="Buscar en DogsHome…" maxlength="120" autocapitalize="off" autocorrect="off" spellcheck="false" autocomplete="off" tabindex="3">
                <span class="material-icons-outlined" style="color: #d3d3d3; cursor: pointer; user-select: none" onclick="searchPost()">search</span>
            </div>
        </form>
    </div>
    <div class="top-bar-section-cont" id="userSpace" style="flex: 1; align-items: center; justify-content: flex-end;">
        <span class="material-icons-outlined" id="fav-button" style="color: #fff; cursor: pointer; margin: 0 10px; user-select: none;" onclick="expandMenu()">menu</span>
        <a class="desktop-elements nav-buttons" id="profile-name" style="margin-right: 0; padding-right: 10px" onclick="navigateToProfile()"></a>
        <% if (isPrivate) {%>
            <img class="desktop-elements" id="profile-pic" onclick="window.location.href = '/signin'" src=<%=myPhoto%>
            alt="profile pic" style="height: 40px; width: 40px; cursor: pointer; margin-right: 10px; user-select:
            none; border-radius: 80px; object-fit: cover">
        <% } else { %>
            <img class="desktop-elements" id="profile-pic" onclick="window.location.href = '/perfil/<%= uid %>'" src=<%=myPhoto %>
            alt="profile pic" style="height: 40px; width: 40px; cursor: pointer; margin-right: 10px; user-select:
            none; border-radius: 80px; object-fit: cover">
        <% } %>   
    </div>
</div>
    <div class="expandible-menu-invisible" id="expandible-menu">
        <div class="expandible-menu-option-cont" id="name-option-exp-menu">
            <img id="profile-pic-exp-menu" src="<%= myPhoto %>" alt="profile pic" style="height: 55px; width: 55px; cursor: pointer; margin-right: 10px; user-select: none; border-radius: 80px; object-fit: cover">
            <a id="exp-menu-name"><%= myName %> <%= mySurname %></a>
        </div>
        <ul class="exp-options-container">
            <li>
                <a href="/inicio">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" fill="#333" height="24"><path fill-rule="evenodd" d="M11.03 2.59a1.5 1.5 0 011.94 0l7.5 6.363a1.5 1.5 0 01.53 1.144V19.5a1.5 1.5 0 01-1.5 1.5h-5.75a.75.75 0 01-.75-.75V14h-2v6.25a.75.75 0 01-.75.75H4.5A1.5 1.5 0 013 19.5v-9.403c0-.44.194-.859.53-1.144l7.5-6.363zM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 01.75-.75h3.5a.75.75 0 01.75.75v6.25h5v-9.403L12 3.734z"></path></svg>
                    <span>Inicio</span>
                </a>
            </li>
            <li>
                <a href="/alertas">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24"><path d="M12 13.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path><path fill-rule="evenodd" d="M19.071 3.429C15.166-.476 8.834-.476 4.93 3.429c-3.905 3.905-3.905 10.237 0 14.142l.028.028 5.375 5.375a2.359 2.359 0 003.336 0l5.403-5.403c3.905-3.905 3.905-10.237 0-14.142zM5.99 4.489A8.5 8.5 0 0118.01 16.51l-5.403 5.404a.859.859 0 01-1.214 0l-5.378-5.378-.002-.002-.023-.024a8.5 8.5 0 010-12.02z"></path></svg>
                    <span>Alertas</span>
                </a>
            </li>
            <li>
                <a href="/favoritos">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24"><path fill-rule="evenodd" d="M6.736 4C4.657 4 2.5 5.88 2.5 8.514c0 3.107 2.324 5.96 4.861 8.12a29.66 29.66 0 004.566 3.175l.073.041.073-.04c.271-.153.661-.38 1.13-.674.94-.588 2.19-1.441 3.436-2.502 2.537-2.16 4.861-5.013 4.861-8.12C21.5 5.88 19.343 4 17.264 4c-2.106 0-3.801 1.389-4.553 3.643a.75.75 0 01-1.422 0C10.537 5.389 8.841 4 6.736 4zM12 20.703l.343.667a.75.75 0 01-.686 0l.343-.667zM1 8.513C1 5.053 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262a31.146 31.146 0 01-5.233 3.576l-.025.013-.007.003-.002.001-.344-.666-.343.667-.003-.002-.007-.003-.025-.013A29.308 29.308 0 0110 20.408a31.147 31.147 0 01-3.611-2.632C3.8 15.573 1 12.332 1 8.514z"></path></svg>
                    <span>Favoritos</span>
                </a>
            </li>
            <li>
                <% if (isPrivate) { %>
                    <a href="/signin">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24">
                            <path fill-rule="evenodd"
                                  d="M12 2.5a5.5 5.5 0 00-3.096 10.047 9.005 9.005 0 00-5.9 8.18.75.75 0 001.5.045 7.5 7.5 0 0114.993 0 .75.75 0 101.499-.044 9.005 9.005 0 00-5.9-8.181A5.5 5.5 0 0012 2.5zM8 8a4 4 0 118 0 4 4 0 01-8 0z"></path>
                        </svg>
                        <span>Iniciar Sesión</span>
                    </a>
                <% } else { %>
                    <a href="/perfil/<%= uid %>">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24">
                            <path fill-rule="evenodd" d="M12 2.5a5.5 5.5 0 00-3.096 10.047 9.005 9.005 0 00-5.9 8.18.75.75 0 001.5.045 7.5 7.5 0 0114.993 0 .75.75 0 101.499-.044 9.005 9.005 0 00-5.9-8.181A5.5 5.5 0 0012 2.5zM8 8a4 4 0 118 0 4 4 0 01-8 0z"></path>
                        </svg>
                        <span  class="selected" >Mi perfil</span>
                    </a>
                <% } %>  
            </li>
            <li>
                <% if(!isPrivate){ %>
                    <a onclick="showSignOutAlert()" style="cursor: pointer">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#ff0000" width="24" height="24">
                            <path fill-rule="evenodd" d="M3 3.25c0-.966.784-1.75 1.75-1.75h5.5a.75.75 0 010 1.5h-5.5a.25.25 0 00-.25.25v17.5c0 .138.112.25.25.25h5.5a.75.75 0 010 1.5h-5.5A1.75 1.75 0 013 20.75V3.25zm16.006 9.5l-3.3 3.484a.75.75 0 001.088 1.032l4.5-4.75a.75.75 0 000-1.032l-4.5-4.75a.75.75 0 00-1.088 1.032l3.3 3.484H10.75a.75.75 0 000 1.5h8.256z"></path>
                        </svg>
                        <span style="color: #ff0000">Cerrar sesión</span>
                    </a>
                <% } %>  
            </li>
        </ul>
    </div>
    <div id="all-container">
        <div id="post">
            <div style="flex-direction: row; display: flex; width: 100%; height: 100%">
                <div id="post-images-selector">
                    <div class="secondary-image-cont-selected" id="primary-image-cont-min" onclick="onSecondaryImageClick(this.id)">
                        <img src="<%= photo %> " alt class="secondary-image" id="primary-image-min">
                    </div>
                    <% secPhotos.forEach(function(photo) { %>
                        <div class="secondary-image-cont-unselected" id="secondary-image<%= secPhotos.indexOf(photo) %>" onclick="onSecondaryImageClick(this.id)">
                            <img src="<%= photo %>" alt class="secondary-image">
                        </div>
                    <% }) %>
                </div>
                <div id="left-post">
                    <div id="post-image-container">
                        <img id="post-image" src="<%= photo %> " alt>
                        <!--Creates the slider-->
                        <div id="splide-slider-wrapper">
                            <div id="main-wrapper">
                                <div class="splide" id="splide-slider-main">
                                    <div class="splide__track">
                                        <ul class="splide__list">
                                            <% allPhotos.forEach(function(photo){%>
                                                <li class="splide__slide">
                                                    <img src="<%= photo %> " class="main-slider-image" alt>
                                                </li>
                                            <%});%>
                                        </ul>
                                    </div>
                                  </div>
                            </div>
                            <div id="thumbnail-wrapper">
                                <div class="splide" id="splide-slider">
                                    <div class="splide__track">
                                        <ul class="splide__list">
                                            <% allPhotos.forEach(function(photo){%>
                                                <li class="splide__slide">
                                                    <img src="<%= photo %>" alt>
                                                </li>
                                            <%});%>
                                        </ul>
                                    </div>
                                  </div>
                            </div>
                        </div>
                        <div id="publication-content-mobile" class="mobile">
                            <div class="post-name-mobile-container">
                                <a id="post-name-mobile"><%= name %></a>
                                <a></a>
                                <a id="post-shelter-name"> <%= ShelterName %></a>
                            </div>
                            <div id="publication-description-mobile" class="mobile">
                                <a style="font-weight: bolder; color: rgba(0, 0, 0, 0.75); margin-bottom: 10px;">Descripción</a>
                                <p id="publication-description-text-mobile"><%= description %></p>
                            </div>
                            <div class="post-details-mobile mobile">
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Castrado: </a>
                                    <a class="detail-prop"><%- castrated ? 'Sí' : 'No'%></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Amigable con gatos: </a>
                                    <a class="detail-prop"><%- catfriendly ? 'Sí' : 'No'%></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Amigable con perros: </a>
                                    <a class="detail-prop"><%- dogfriendly ? 'Sí' : 'No'%></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Amigable con niños: </a>
                                    <a class="detail-prop"><%- kidsfriendly ? 'Sí' : 'No'%></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Color: </a>
                                    <a class="detail-prop"><%= color %></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Tamaño: </a>
                                    <a class="detail-prop"><%= size %></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Edad (Años): </a>
                                    <a class="detail-prop"><%= ageInYears %></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Edad (Meses): </a>
                                    <a class="detail-prop"><%= ageInMonths %></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Raza: </a>
                                    <a class="detail-prop"><%= breed %></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Amigable con los gatos: </a>
                                    <a class="detail-prop"><%- catfriendly ? 'Sí' : 'No'%></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Vacunado: </a>
                                    <a class="detail-prop"><%- vaccinated ? 'Sí' : 'No'%></a>
                                </div>
                                <div class="detail-cont">
                                    <a class="detail-name-mobile">Desparasitado: </a>
                                    <a class="detail-prop"><%- dewormed ? 'Sí' : 'No'%></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="secondary-images-container-mobile">
                        <% secPhotos.forEach(function(photo) { %>
                            <div class="secondary-image-cont-unselected" id="secondary-image-mobile<%= secPhotos.indexOf(photo) %>" onclick="onSecondaryImageClick(this.id)">
                                <img src="<%= photo %>" alt class="secondary-image">
                            </div>
                        <% }) %>
                    </div>
                </div>
            </div>

            <div id="right-post">
                <div id="publication-details">
                    <div style="width: auto; height:fit-content; display:flex; flex-direction:row; align-items:flex-end; justify-content: center">
                        <a id="post-name-mobile"><%= name %></a>
                        <a></a>
                        <a id="post-shelter-name"> <%= ShelterName %></a>
                    </div>
                    <div class="post-details">
                        <div class="detail-cont">
                            <a class="detail-name">Castrado: </a>
                            <a class="detail-prop"><%- castrated ? 'Sí' : 'No'%></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Amigable con gatos: </a>
                            <a class="detail-prop"><%- catfriendly ? 'Sí' : 'No'%></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Amigable con perros: </a>
                            <a class="detail-prop"><%- dogfriendly ? 'Sí' : 'No'%></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Amigable con niños: </a>
                            <a class="detail-prop"><%- kidsfriendly ? 'Sí' : 'No'%></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Color: </a>
                            <a class="detail-prop"><%= color %></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Tamaño: </a>
                            <a class="detail-prop"><%= size %></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Edad (Años): </a>
                            <a class="detail-prop"><%= ageInYears %></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Edad (Meses): </a>
                            <a class="detail-prop"><%= ageInMonths %></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Raza: </a>
                            <a class="detail-prop"><%= breed %></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Amigable con los gatos: </a>
                            <a class="detail-prop"><%- catfriendly ? 'Sí' : 'No'%></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Vacunado: </a>
                            <a class="detail-prop"><%- vaccinated ? 'Sí' : 'No'%></a>
                        </div>
                        <div class="detail-cont">
                            <a class="detail-name">Desparasitado: </a>
                            <a class="detail-prop"><%- dewormed ? 'Sí' : 'No'%></a>
                        </div>
                    </div>
                </div>
                <div id="publication-actions">
                    <a class="action-button-circle" id="share-btn" onclick="share()">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#079292" viewBox="0 0 24 24" width="24" height="24"><path fill-rule="evenodd" d="M20 5.5a3.5 3.5 0 01-6.062 2.385l-5.112 3.021a3.497 3.497 0 010 2.188l5.112 3.021a3.5 3.5 0 11-.764 1.29l-5.112-3.02a3.5 3.5 0 110-4.77l5.112-3.021v.001A3.5 3.5 0 1120 5.5zm-1.5 0a2 2 0 11-4 0 2 2 0 014 0zM5.5 14a2 2 0 100-4 2 2 0 000 4zm13 4.5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                    </a>
                    <a class="action-button-circle">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#079292" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.75.75 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5zM8 14.25l-.345.666-.002-.001-.006-.003-.018-.01a7.643 7.643 0 01-.31-.17 22.075 22.075 0 01-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.08 22.08 0 01-3.744 2.584l-.018.01-.006.003h-.002L8 14.25zm0 0l.345.666a.752.752 0 01-.69 0L8 14.25z"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        <div id="description-container">
            <p id="description"><%= description %> </p>
        </div>
    </div>

    <script src="https://dogshome-6af88.web.app/__/firebase/8.6.5/firebase-app.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://dogshome-6af88.web.app/__/firebase/8.6.5/firebase-auth.js"></script>
    <script src="https://dogshome-6af88.web.app/__/firebase/8.6.5/firebase-database.js"></script>
    <script src="https://dogshome-6af88.web.app/__/firebase/init.js"></script>

    <script src="/scripts/profile/profile-settings-functions.js"></script>
    <script src="/scripts/auth/sign-out.js"></script>

    <script>
        function onSecondaryImageClick(id) {
            document.getElementById(id).className = 'secondary-image-cont-selected';
            var secondaryImagesCont = document.getElementById("post-images-selector");
            var secondaryImagesArray = secondaryImagesCont.getElementsByTagName('div');
            unselectOthersOnClick(id, secondaryImagesArray);
            document.getElementById("post-image").src = document.getElementById(id).getElementsByTagName("img")[0].src;
        }

        function unselectOthersOnClick(exception_id, all_secondary_photos) {
            for (let key in all_secondary_photos) {
                if (all_secondary_photos[key].id !== exception_id) {
                    all_secondary_photos[key].className = "secondary-image-cont-unselected";
                }
            }
        }

        function share(){
            if(Navigator.share){
                Navigator.share({url: window.location}).then(() => {
                    console.log('Successful share');
                }).catch((error) => {
                    console.log('Error sharing', error);
                });
            }else{
                window.prompt("Copiar link", window.location);
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            var main = new Splide('#splide-slider-main', {
                type: 'slide',
                rewind: true,
                pagination: false,
                arrows: false,
                width: '100%',
                height: '100%',
                gap: 50,
                perPage: 1,
            })
            var thumbnails = new Splide('#splide-slider', {
                fixedWidth: 100,
                fixedHeight: 60,
                gap: 10,
                rewind: true,
                pagination: false,
                cover: true,
                isNavigation: true,
                breakpoints: {
                    800: {
                        fixedWidth: 60,
                        fixedHeight: 44,
                    },
                },
                dragMinThreshold: {
                        mouse: 50,
                        touch: 10,
                },
            });

            main.sync(thumbnails);
            main.mount();
            thumbnails.mount();
        });
    </script>
</body>
</html>