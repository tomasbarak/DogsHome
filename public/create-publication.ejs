<!DOCTYPE html>
<html lang="es">
<head>
    <%- include('./head.ejs'); %>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear publicación</title>
    <script src="/scripts/main/basic-navigation.js"></script>
    <script src="/scripts/auth/sign-out.js"></script>
    <script src="/scripts/main/open-close-drawer.js"></script>
    <script src="/scripts/publications/expand-menu.js"></script>

    <%- include('./stylesheets/main/style-mainpage.ejs'); %>
    <%- include('./stylesheets/main/content-show.ejs'); %>
    <%- include('./stylesheets/main/drawer-navigator-style.ejs'); %>
    <link rel="stylesheet" href="/stylesheets/publications/expandible-menu.css">

    <link rel="icon" href="/images/DogsHomeLogo-ReDesign%20(Colorified&Final).png">

    <style>
        *{
            font-family: 'Lato', sans-serif;
        }
        .create-title {
            font-size: 2.5rem;
            font-family: 'Lato', sans-serif;
            color: white;
            font-weight: bold;
        }
    </style>
    <style>
        .swal2-shown{
            display: flex;
            height: 100% !important;
        }
        
        #buttons-container{
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: fit-content;
            display: flex;
            flex-direction: row-reverse;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
            padding: 15px;
        }
        #next-button{
            transition: .5s;
            width: 100px;
            height: 50px;
            border-radius: 5px;
            background-color: #079292;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 15px;
            text-decoration: none;
            box-shadow: 0px 0px 5px rgba(0, 0, 0, .75);
            cursor: pointer;
        }
        #logout-button{
            transition: .5s;
            width: 100px;
            height: 50px;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, .15);
            display: flex;
            justify-content: center;
            align-items: center;
            color: red;
            font-size: 15px;
            text-decoration: none;
            cursor: pointer;
        }
        #logout-button:hover{
            transition: .5s;
            color: rgb(200, 0, 0)
        }
        #next-button:hover{
            transition: .5s;
            background-color: rgb(17, 156, 156);
            box-shadow: 0px 0px 10px rgba(7, 146, 146, .75);
        }
        #action-buttons-container{
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: fit-content;
            height: fit-content;
        }
        #skip-button{
            margin-bottom: 15px;
            cursor: pointer;
            margin-left: 24px;
        }
        #action-btn-subcontainer{
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            width: fit-content;
            height: fit-content;
        }
    </style>
</head>
<body>
    <section id="drawer-navigator-dim" class="dim-null">
        <section id="drawer-navigator" class="drawer-closed" style="z-index: 100">

        </section>
        <section onclick="drawerAction()" style="width: 25%; height: 100%; position: absolute; top: 0; right: 0">
        </section>
    </section>

    <div id="search-bar">
        <div class="top-bar-section-cont" style="flex-direction: row; align-items: center;">
            <img loading="lazy" src="/images/DogsHomeLogo-ReDesign%20(White&Final).png" alt="Dogshome logo"
                style="height: 50px; width: 50px; margin-right: 10px">
        </div>
        <div class="top-bar-section-cont">
            
        </div>
        <div class="top-bar-section-cont" id="userSpace"
            style="flex: 1; align-items: center; justify-content: flex-end;">
            <span class="material-icons-outlined" id="fav-button"
                style="color: #fff; cursor: pointer; margin: 0 10px; user-select: none;"
                onclick="expandMenu()">menu</span>
            <a class="desktop-elements nav-buttons" id="profile-name" style="margin-right: 0; padding-right: 10px"
                onclick="navigateToProfile()"></a>
            <% if (isPrivate) {%>
                <img loading="lazy" class="desktop-elements" id="profile-pic" onclick="window.location.href = '/signin'" src=<%=photoUrl %>
                alt="profile pic" style="height: 40px; width: 40px; cursor: pointer; margin-right: 10px; user-select:
                none; border-radius: 80px; object-fit: cover">
            <% } else { %>
                <img loading="lazy" class="desktop-elements" id="profile-pic" onclick="window.location.href = '/perfil/<%= uid %>'" src=<%=photoUrl %>
                alt="profile pic" style="height: 40px; width: 40px; cursor: pointer; margin-right: 10px; user-select:
                none; border-radius: 80px; object-fit: cover">
            <% } %>   
            
        </div>
    </div>
    <div class="expandible-menu-invisible" id="expandible-menu">
        <div class="expandible-menu-option-cont" id="name-option-exp-menu">
            <img loading="lazy" class="" id="profile-pic-exp-menu" src=<%=photoUrl %> alt="profile pic" style="height: 55px; width:
            55px; cursor: pointer; margin-right: 10px; user-select: none; border-radius: 80px; object-fit: cover">
            <a id="exp-menu-name">
                <%= displayName %>
            </a>
        </div>
        <ul class="exp-options-container">
            <li>
                <a href="/inicio">
                    <svg xmlns="http://www.w3.org/2000/svg" class="" viewBox="0 0 24 24" width="24"
                        fill="#333" height="24">
                        <path fill-rule="evenodd"
                            d="M11.03 2.59a1.5 1.5 0 011.94 0l7.5 6.363a1.5 1.5 0 01.53 1.144V19.5a1.5 1.5 0 01-1.5 1.5h-5.75a.75.75 0 01-.75-.75V14h-2v6.25a.75.75 0 01-.75.75H4.5A1.5 1.5 0 013 19.5v-9.403c0-.44.194-.859.53-1.144l7.5-6.363zM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 01.75-.75h3.5a.75.75 0 01.75.75v6.25h5v-9.403L12 3.734z">
                        </path>
                    </svg>
                    <span class="">Inicio</span>
                </a>
            </li>
            <li>
                <a href="alertas">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24">
                        <path d="M12 13.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path>
                        <path fill-rule="evenodd"
                            d="M19.071 3.429C15.166-.476 8.834-.476 4.93 3.429c-3.905 3.905-3.905 10.237 0 14.142l.028.028 5.375 5.375a2.359 2.359 0 003.336 0l5.403-5.403c3.905-3.905 3.905-10.237 0-14.142zM5.99 4.489A8.5 8.5 0 0118.01 16.51l-5.403 5.404a.859.859 0 01-1.214 0l-5.378-5.378-.002-.002-.023-.024a8.5 8.5 0 010-12.02z">
                        </path>
                    </svg>
                    <span>Alertas</span>
                </a>
            </li>
            <li>
                <a href="favoritos">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24">
                        <path fill-rule="evenodd"
                            d="M6.736 4C4.657 4 2.5 5.88 2.5 8.514c0 3.107 2.324 5.96 4.861 8.12a29.66 29.66 0 004.566 3.175l.073.041.073-.04c.271-.153.661-.38 1.13-.674.94-.588 2.19-1.441 3.436-2.502 2.537-2.16 4.861-5.013 4.861-8.12C21.5 5.88 19.343 4 17.264 4c-2.106 0-3.801 1.389-4.553 3.643a.75.75 0 01-1.422 0C10.537 5.389 8.841 4 6.736 4zM12 20.703l.343.667a.75.75 0 01-.686 0l.343-.667zM1 8.513C1 5.053 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262a31.146 31.146 0 01-5.233 3.576l-.025.013-.007.003-.002.001-.344-.666-.343.667-.003-.002-.007-.003-.025-.013A29.308 29.308 0 0110 20.408a31.147 31.147 0 01-3.611-2.632C3.8 15.573 1 12.332 1 8.514z">
                        </path>
                    </svg>
                    <span>Favoritos</span>
                </a>
            </li>
            <li>
                <% if (isPrivate) {%> 
                    <a href="/signin">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24">
                            <path fill-rule="evenodd"
                                d="M12 2.5a5.5 5.5 0 00-3.096 10.047 9.005 9.005 0 00-5.9 8.18.75.75 0 001.5.045 7.5 7.5 0 0114.993 0 .75.75 0 101.499-.044 9.005 9.005 0 00-5.9-8.181A5.5 5.5 0 0012 2.5zM8 8a4 4 0 118 0 4 4 0 01-8 0z">
                            </path>
                        </svg>
                        <span>Iniciar Sesión</span>
                    </a>
                <% } else { %>
                    <a href="/perfil/<%= uid %>">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333" width="24" height="24">
                            <path fill-rule="evenodd"
                                d="M12 2.5a5.5 5.5 0 00-3.096 10.047 9.005 9.005 0 00-5.9 8.18.75.75 0 001.5.045 7.5 7.5 0 0114.993 0 .75.75 0 101.499-.044 9.005 9.005 0 00-5.9-8.181A5.5 5.5 0 0012 2.5zM8 8a4 4 0 118 0 4 4 0 01-8 0z">
                            </path>
                        </svg>
                        <span>Mi perfil</span>
                    </a>
                <% } %> 
            </li>
            <li>
                <% if (!isPrivate) { %>
                    <a onclick="signOut()" style="cursor: pointer">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#ff0000" width="24"
                            height="24">
                            <path fill-rule="evenodd"
                                d="M3 3.25c0-.966.784-1.75 1.75-1.75h5.5a.75.75 0 010 1.5h-5.5a.25.25 0 00-.25.25v17.5c0 .138.112.25.25.25h5.5a.75.75 0 010 1.5h-5.5A1.75 1.75 0 013 20.75V3.25zm16.006 9.5l-3.3 3.484a.75.75 0 001.088 1.032l4.5-4.75a.75.75 0 000-1.032l-4.5-4.75a.75.75 0 00-1.088 1.032l3.3 3.484H10.75a.75.75 0 000 1.5h8.256z">
                            </path>
                        </svg>
                        <span style="color: #ff0000">Cerrar sesión</span>
                    </a>
                <% } %> 
            </li>
        </ul>
    </div>
    
    <%- include(`./draft-steps/step_${step}.ejs`) %>
    
    <div id="buttons-container">
        <div id="action-buttons-container">
            <% if (false) { %>
                <a id="skip-button" onclick="skipStep()">Saltar</a>
            <% } %>
            <div id="action-btn-subcontainer">
                <% if (step > 1) { %>
                    <svg id="back-button" style="margin-bottom: 8px; margin-right: 5px;  cursor: pointer; display: flex;" onclick="stepBack('<%= draftId %>')" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="24" height="24"><path fill-rule="evenodd" d="M9.78 12.78a.75.75 0 01-1.06 0L4.47 8.53a.75.75 0 010-1.06l4.25-4.25a.75.75 0 011.06 1.06L6.06 8l3.72 3.72a.75.75 0 010 1.06z"></path></svg>
                <% } %>
                <a id="next-button" onclick="updateDraft('<%= draftId %>')">Siguiente</a>
            </div>
        </div>
    </div>
    <script>
        const stepBack = (draftId) => {
            Swal.fire({
                title: 'Volviendo al paso anterior',
                text: 'Esperá un momento',
                didOpen: () => {
                    Swal.showLoading();
                },
                allowOutsideClick: false,
                allowEscapeKey: false,
                allowEnterKey: false,

            });
            axios.post(`https://${window.location.hostname}/update/publication/draft/${draftId}/`, {
                step: 'back',
            }).then(res => {
                if(res.status === 200){
                    window.location.reload();
                }else{
                    Swal.fire({
                        type: 'error',
                        title: 'Oops...',
                        text: 'Algo salió mal, intenta de nuevo',
                        confirmButtonColor: '#079292'
                    });
                }
            }).catch(err => {
                console.log(err);
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Algo salió mal, intenta de nuevo',
                    confirmButtonColor: '#079292'
                });
            });
        } 
    </script>
        
</body>
</html>