<!DOCTYPE html>
<html lang="es">

<head>
    <%- include('./head.ejs'); %>

    <title>Crear cuenta</title>

    <link rel="canonical" href="https://dogshome.com.ar/signup">
    <link href="/stylesheets/auth-ui/auth-pages-style.css" rel="stylesheet">
    <link rel="icon" href="/images/DogsHomeLogo-ReDesign%20(Colorified&Final).png">
    <link rel="stylesheet" href="/stylesheets/auth-ui/stength-pass-show.css">

    <script src="/scripts/auth/create-account-flow.js"></script>
    <script src="/scripts/auth/save-profile-data.js"></script>

</head>

<body onload="//setInicialInstance()" style="display: flex; flex-direction: column; justify-content: flex-start">

    <section class="auth-page-body">
        <img id="dogshome-logo" src="/images/DogsHomeLogo-ReDesign%20(Colorified&Final).png" alt="DogsHome Logo">
        <a id="dogshome-name">DogsHome</a>

        <svg class="wave" viewBox="0 0 320 1440" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
            <g id="Layer_1">
                <title>Layer 1</title>
                <g id="svg_1" transform="rotate(90, 159.909, 719.709)">
                    <path id="svg_2" fill="#079292" d="m-560.09116,650.12319l80,25.42733c80,25.90484 240,76.04324 400,57.30103c160,-19.45847 320,-107.79756 480,-146.35638c160,-37.84255 320,-25.90484 400,-19.10034l80,6.32699l0,305.60548l-80,0c-80,0 -240,0 -400,0c-160,0 -320,0 -480,0c-160,0 -320,0 -400,0l-80,0l0,-229.20411z" />
                </g>
            </g>
        </svg>

        <div id="sign-up-form" class="auth-page-form">
            <div id="loading-container">
                <div class="loader-4 btn-loading" id="loading"><span></span></div>
            </div>

            <h1 class="auth-form-title"> Registráte </h1>

            <div class="input-container">
                <label for="mail">E-mail: </label>
                <input placeholder="ejemplo@gmail.com" id="mail" type="email" pattern="([A-Za-z0-9][._]?)+[A-Za-z0-9]@[A-Za-z0-9]+(\.?[A-Za-z0-9]){2}\.(com?|net|org)+(\.[A-Za-z0-9]{2,4})?">

                <div class="error-label-container" id="mail-error-container">
                    <svg class="error-label-icon" id="mail-error-icon" xmlns="http://www.w3.org/2000/svg" fill="#B00020" viewBox="0 0 16 16" width="16" height="16">
                        <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
                    </svg>
                    <a class="error-label" id="mail-error-msg"></a>
                </div>
            </div>

            <div class="input-container">
                <label for="password">Contraseña: </label>

                <div style="width: calc(100% + 20px); display: flex; flex-direction: row; margin-right: -20px">
                    <input oninput="equalPasswordsChecker(this.value, document.getElementById('password-repeat').value)" placeholder="Contraseña" id="password" type="password">
                    <svg onclick="setPasswordsVisibility(document.getElementById('eye-password-path').getAttribute('d'))" id="eye-password" xmlns="http://www.w3.org/2000/svg" fill="#222222" style="margin-left: 5px; cursor: pointer" viewBox="0 0 16 16" width="15" height="15">
                        <path id="eye-password-path" fill-rule="evenodd" d="M1.679 7.932c.412-.621 1.242-1.75 2.366-2.717C5.175 4.242 6.527 3.5 8 3.5c1.473 0 2.824.742 3.955 1.715 1.124.967 1.954 2.096 2.366 2.717a.119.119 0 010 .136c-.412.621-1.242 1.75-2.366 2.717C10.825 11.758 9.473 12.5 8 12.5c-1.473 0-2.824-.742-3.955-1.715C2.92 9.818 2.09 8.69 1.679 8.068a.119.119 0 010-.136zM8 2c-1.981 0-3.67.992-4.933 2.078C1.797 5.169.88 6.423.43 7.1a1.619 1.619 0 000 1.798c.45.678 1.367 1.932 2.637 3.024C4.329 13.008 6.019 14 8 14c1.981 0 3.67-.992 4.933-2.078 1.27-1.091 2.187-2.345 2.637-3.023a1.619 1.619 0 000-1.798c-.45-.678-1.367-1.932-2.637-3.023C11.671 2.992 9.981 2 8 2zm0 8a2 2 0 100-4 2 2 0 000 4z"></path>
                    </svg>
                </div>

                <div class="error-label-container" id="password-error-container">
                    <svg class="error-label-icon" id="password-error-icon" xmlns="http://www.w3.org/2000/svg" fill="#B00020" viewBox="0 0 16 16" width="16" height="16">
                        <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
                    </svg>
                    <a class="error-label" id="password-error-msg"></a>
                </div>

                <a id="password-strength-label"></a>

                <div style="width: calc(100% + 20px); display: flex; flex-direction: row; align-items: center; justify-content: center">
                    <div id="password-strength-container">
                        <div id="password-strength"></div>
                    </div>
                    <svg id="password-check-icon" style="margin-left: 5px" fill="#4BB543" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="15" height="15">
                        <path fill-rule="evenodd" d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM0 8a8 8 0 1116 0A8 8 0 010 8zm11.78-1.72a.75.75 0 00-1.06-1.06L6.75 9.19 5.28 7.72a.75.75 0 00-1.06 1.06l2 2a.75.75 0 001.06 0l4.5-4.5z"></path>
                    </svg>
                </div>
            </div>



            <div class="input-container">
                <label for="password-repeat">Repetir contraseña: </label>
                <input oninput="equalPasswordsChecker(document.getElementById('password').value, this.value)" placeholder="Repetir contraseña" id="password-repeat" type="password" onkeypress="enter(document.getElementById('mail').value, document.getElementById('password').value, document.getElementById('password-repeat').value)">

                <div style="width: calc(100% + 20px); display: flex; flex-direction: row; align-items: center; justify-content: center">
                    <div style="width: 100%"></div>
                    <svg id="password-repeat-check-icon" style="margin-left: 5px" fill="#4BB543" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="15" height="15">
                        <path fill-rule="evenodd" d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM0 8a8 8 0 1116 0A8 8 0 010 8zm11.78-1.72a.75.75 0 00-1.06-1.06L6.75 9.19 5.28 7.72a.75.75 0 00-1.06 1.06l2 2a.75.75 0 001.06 0l4.5-4.5z"></path>
                    </svg>
                </div>

                <div class="error-label-container" id="password-repeat-error-container">
                    <svg class="error-label-icon" id="password-repeat-error-icon" xmlns="http://www.w3.org/2000/svg" fill="#B00020" viewBox="0 0 16 16" width="16" height="16">
                        <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
                    </svg>
                    <a class="error-label" id="password-repeat-error-msg"></a>
                </div>

            </div>

            <div class="auth-btn-container">
                <a href="#" id="sign-in-btn" class="auth-btn">Siguiente</a>
                <a href="/login" class="auth-page-change-method">¿Ya tenes cuenta? Iniciá sesión</a>
            </div>
        </div>
    </section>

    <script>
        function loading(show) {
            const loading = document.getElementById('loading-container');
            if (show) {
                loading.classList.add("visible")
            } else {
                loading.classList.remove("visible")
            }
        }
    </script>

    <script>
        const mail_input = document.getElementById('mail');
        const password_input = document.getElementById('password');
        const password_repeat_input = document.getElementById('password-repeat');
        const sign_up_btn = document.getElementById('sign-in-btn');

        mail_input.addEventListener('input', () => {
            hideError(`${mail_input.id}`);
        });

        password_input.addEventListener('input', () => {
            hideError(`${password_input.id}`);
        });

        password_repeat_input.addEventListener('input', () => {
            hideError(`${password_repeat_input.id}`);
        });

        sign_up_btn.addEventListener('click', () => {
            loading(true);
            signUp(mail_input.value, password_input.value, password_repeat_input.value).then(() => {
                window.location.reload();
            }).catch((error) => {
                loading(false);
                switch(error.code) {
                    case "auth/email-already-exists":
                        swal.fire({
                            title: "Error",
                            text: "El email ingresado ya está en uso",
                            icon: "error",
                            confirmButtonText: "Aceptar",
                            confirmButtonColor: "#079292"
                        });
                        break;
                    case "auth/invalid-email":
                        swal.fire({
                            title: "Error",
                            text: "El email ingresado no es válido",
                            icon: "error",
                            confirmButtonText: "Aceptar",
                            confirmButtonColor: "#079292"
                        });
                        break;
                    case "auth/weak-password":
                        swal.fire({
                            title: "Error",
                            text: "La contraseña ingresada es muy débil",
                            icon: "error",
                            confirmButtonText: "Aceptar",
                            confirmButtonColor: "#079292"
                        });
                        break;
                    case "auth/invalid-password":
                        swal.fire({
                            title: "Error",
                            text: "La contraseña ingresada no es válida",
                            icon: "error",
                            confirmButtonText: "Aceptar",
                            confirmButtonColor: "#079292"
                        });
                        break;
                    case "auth/passwords-not-match":
                        swal.fire({
                            title: "Error",
                            text: "Las contraseñas ingresadas no coinciden",
                            icon: "error",
                            confirmButtonText: "Aceptar",
                            confirmButtonColor: "#079292"
                        });
                        break;
                    default:
                        swal.fire({
                            title: "Error",
                            text: "Ha ocurrido un error inesperado",
                            icon: "error",
                            confirmButtonText: "Aceptar",
                            confirmButtonColor: "#079292"
                        });
                        break;
                }
            });
        });
    </script>

    <!--Firebase Scripts -->

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://dogshome-6af88.web.app/__/firebase/8.6.5/firebase-app.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://dogshome-6af88.web.app/__/firebase/8.6.5/firebase-auth.js"></script>
    <script src="https://dogshome-6af88.web.app/__/firebase/8.6.5/firebase-database.js"></script>

    <script src="https://dogshome-6af88.web.app/__/firebase/init.js"></script>
    <script src="https://dogshome-6af88.web.app/__/firebase/8.8.0/firebase-app-check.js"></script>
    <script>
        const appCheck = firebase.appCheck();
        // Pass your reCAPTCHA v3 site key (public key) to activate(). Make sure this
        // key is the counterpart to the secret key you set in the Firebase console.
        appCheck.activate('6LdffbsbAAAAAPN35hXgqZJGvOgpKVZezCzhEsfI');
    </script>

    <script src="/scripts/auth/sign-up.js"></script>
    <script src="/scripts/auth/password-strength-checker.js"></script>
    <script src="/scripts/auth/auth-flow-autorefresh.js"></script>
</body>

</html>